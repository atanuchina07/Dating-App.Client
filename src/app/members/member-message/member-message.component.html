<div class="card shadow-sm border-0">
  <div
    class="card-body"
    style="max-height: 500px; overflow-y: auto; background-color: #f9f9f9"
  >
    @if (messages().length === 0) {
    <p class="text-center text-muted">No messages yet</p>
    } @else {
    <ul class="chat list-unstyled">
      @for (message of messages(); track message.id) {
      <li class="mb-3">
        <div
          class="d-flex {{
            message.senderUsername === username()
              ? 'justify-content-end'
              : 'justify-content-start'
          }}"
        >
          <div class="d-flex flex-column" style="max-width: 70%">
            <div class="d-flex align-items-center mb-2">
              <img
                class="rounded-circle me-2"
                src="{{ message.senderPhotoUrl || './assets/user.png' }}"
                alt="Sender Image"
                width="40"
                height="40"
              />
              <small class="text-muted">
                <span class="fa fa-clock-o me-1">{{
                  message.messageSent | timeago
                }}</span>
                @if (!message.dateRead && message.senderUsername !== username())
                {
                <span class="text-danger">(unread)</span>
                } @if (message.dateRead && message.senderUsername !==
                username()) {
                <span class="text-success"
                  >(read {{ message.dateRead | timeago }})</span
                >
                }
              </small>
            </div>
            <div
              class="p-3 rounded {{
                message.senderUsername === username()
                  ? 'bg-primary text-white'
                  : 'bg-light text-dark'
              }}"
            >
              {{ message.content }}
            </div>
          </div>
        </div>
      </li>
      }
    </ul>
    }
  </div>

  <!-- Optional footer (can be toggled) -->
  <div class="card-footer bg-white border-top-0">
    <form #messageForm="ngForm" (ngSubmit)="sendMessage()">
      <div class="input-group">
        <input
          name="messageContent"
          required
          [(ngModel)]="messageContent"
          type="text"
          class="form-control"
          placeholder="Send a private message"
        />
        <button
          [disabled]="!messageForm.valid"
          class="btn btn-primary"
          type="submit"
        >
          Send
        </button>
      </div>
    </form>
  </div>
</div>
